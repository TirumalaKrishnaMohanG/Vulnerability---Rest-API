# CIRCL CVE - Rest API - Python
It enables the devolpers/Threat Hunter to fetch the updated CVE { Command Vulnerability Enumeration } from the CIRCL open-source community.

## List of Operation included in REST API
The following operations are added into the REST API
````
 - CVE { Fetch the required CVE information }.
 - CWE { Fetch the required CWE }.
 - CAPEC { CAPEC (Common Attack Pattern Enumeration and Classification) are a list of attack types commonly used by attackers }.
 - Last { It will users to get recently published CVE in CIRLC CVE }.
 - Vendor { The user can quickly lookup for respective product }.
 - DBInfo { Returns the stats of the database }.
````
## Script Setup
The following setup need to be done before execution
````
python ==== 3.*.*
PIP === 20.*.* { Minimum }
````
And the following packages need to be installed
````
1. Requests
2. cowsay
````
After done with the above step.

## Running Script
Use the following command to run the script
````
python app.py 
````
As a result, we can the help menu like below { Which contains the instructions to run the script }
````
  ____
| Help |
  ====
         \
          \
           \
            .--.
           |o_o |
           |:_/ |
          //   \ \
         (|     | )
        /'\_   _/`\
        \___)=(___/
Check with following options:
	-h : --Help --> Help Required
	-c : --cwe -->  Outputs a list of all CWEs (Common Weakness Enumeration).
	-cv : --cve -->  This information includes basic CVE information like CVSS (Common Vulnerability Scoring System), related CPE (Common Product Enumeration), CWE (Common Weakness Enumeration), ... as well as additional information (RedHat Advisories etc).
	-l : --last -->  Outputs the last n amount of vulnerabilities. If the limit is not specified, the default of 30 is used. 
	-lk : --link -->  Returns all CVEs that are linked by a given key/value pair. 
	-cp : --capec -->  Outputs a CAPEC specified by it's id and CAPEC (Common Attack Pattern Enumeration and Classification) are a list of attack types commonly used by attackers.
	-v : --vendor -->  Returns a list of vendors or products of a specific vendor.
	-db : --dbinfo -->Returns the stats of the database.
````
[1]. Use '-c' or '--cwe', Run the following command
````
python app.py -c 1
````
Then output wil be
````
The Requested CWE is 1
[
  {
    "Description": "This category has been deprecated. It was originally used for organizing the Development View (CWE-699), but it introduced unnecessary complexity and depth to the resulting tree.This category has been deprecated. It was originally used for organizing the Development View (CWE-699), but it introduced unnecessary complexity and depth to the resulting tree.",
    "id": "1",
    "name": "DEPRECATED: Location",
    "status": "Deprecated",
    "weaknessabs": "Category"
  }
]
````
Note: If value is not provided, Then it will fetch all CWE's.

[2]. Use '-cv' or '--cve', Run the following command
````
python app.py -cv CVE-2021-37400
````
Then output will be 
````
The requested CVE Id is CVE-2021-37400
 {
  "Modified":"2022-01-07T20:40:00",
  "Published":"2021-12-28T13:15:00",
  "access":{
    "authentication":"NONE",
    "complexity":"LOW",
    "vector":"NETWORK"
  },
  "assigner":"cve@mitre.org",
  "capec":[
    {
      "id":"645",
      "name":"Use of Captured Tickets (Pass The Ticket)",
      "prerequisites":"The adversary needs physical access to the victim system. The use of a third-party credential harvesting tool.",
      "related_weakness":[
        "522"
      ],
      "solutions":"Reset the built-in KRBTGT account password twice to invalidate the existence of any current Golden Tickets and any tickets derived from them. Monitor system and domain logs for abnormal access.",
      "summary":"An adversary uses stolen Kerberos tickets to access systems that leverage the Kerberos authentication protocol. The Kerberos authentication protocol centers around a ticketing system which is used to request/grant access to services and to then access the requested services. An adversary can obtain any one of these tickets (e.g. Service Ticket, Ticket Granting Ticket, Silver Ticket, or Golden Ticket) to authenticate to a system without needing the account's credentials. Depending on the ticket obtained, the adversary may be able to access a particular resource or generate TGTs for any account within an Active Directory Domain."
    },
    {
      "id":"555",
      "name":"Remote Services with Stolen Credentials",
      "prerequisites":"",
      "related_weakness":[
        "522"
      ],
      "solutions":"Disable RDP, telnet, SSH and enable firewall rules to block such traffic. Limit users and accounts that have remote interactive login access. Remove the Local Administrators group from the list of groups allowed to login through RDP. Limit remote user permissions. Use remote desktop gateways and multifactor authentication for remote logins.",
      "summary":"This pattern of attack involves an adversary that uses stolen credentials to leverage remote services such as RDP, telnet, SSH, and VNC to log into a system. Once access is gained, any number of malicious activities could be performed."
    },
    {
      "id":"474",
      "name":"Signature Spoofing by Key Theft",
      "prerequisites":"An authoritative or reputable signer is storing their private signature key with insufficient protection.",
      "related_weakness":[
        "522"
      ],
      "solutions":"Ensure all services are patched and up to date",
      "summary":"An attacker obtains an authoritative or reputable signer's private signature key by theft and then uses this key to forge signatures from the original signer to mislead a victim into performing actions that benefit the attacker."
    },
    {
      "id":"644",
      "name":"Use of Captured Hashes (Pass The Hash)",
      "prerequisites":"The adversary needs to first obtain the hashed credentials of a user, via the use of a tool, prior to executing this attack. The victim system must allow Lan Man or NT Lan Man authentication.",
      "related_weakness":[
        "522"
      ],
      "solutions":"Prevent the use of Lan Man and NT Lan Man authentication on severs and apply patch KB2871997 to Windows 7 and higher systems. Monitor system and domain logs for abnormal credential access. Leverage system penetration testing and other defense in depth methods to determine vulnerable systems within a domain.",
      "summary":"An adversary uses stolen hash values for a user's credentials (username and password) to access systems managed under the same credential framwork that leverage the Lan Man (LM) and/or NT Lan Man (NTLM) authentication protocols. When authenticating via LM or NTLM, the hashed credentials' associated plaintext credentials are not requried for successful authentication. Therefore, if an adversary can obtain the hashed credentials of a user, he can then pass these hash values to the server or service to authenticate without needing to brute-force the hashes to obtain their cleartext values. The adversary can then impersonate the user and laterally move within the network. This technique can be performed against any operating system which leverages the LM or NTLM protocols."
    },
    {
      "id":"102",
      "name":"Session Sidejacking",
      "prerequisites":"An attacker and the victim are both using the same WiFi network. The victim has an active session with a target system. The victim is not using a secure channel to communicate with the target system (e.g. SSL, VPN, etc.) The victim initiated communication with a target system that requires transfer of the session token or the target application uses AJAX and thereby periodically \"rings home\" asynchronously using the session token",
      "related_weakness":[
        "294",
        "319",
        "522",
        "523",
        "614"
      ],
      "solutions":"Make sure that HTTPS is used to communicate with the target system. Alternatively, use VPN if possible. It is important to ensure that all communication between the client and the server happens via an encrypted secure channel. Modify the session token with each transmission and protect it with cryptography. Add the idea of request sequencing that gives the server an ability to detect replay attacks.",
      "summary":"Session sidejacking takes advantage of an unencrypted communication channel between a victim and target system. The attacker sniffs traffic on a network looking for session tokens in unencrypted traffic. Once a session token is captured, the attacker performs malicious actions by using the stolen token with the targeted application to impersonate the victim. This attack is a specific method of session hijacking, which is exploiting a valid session token to gain unauthorized access to a target system or information. Other methods to perform a session hijacking are session fixation, cross-site scripting, or compromising a user or server machine and stealing the session token."
    },
    {
      "id":"551",
      "name":"Modify Existing Service",
      "prerequisites":"",
      "related_weakness":[
        "284",
        "522"
      ],
      "solutions":"Limit privileges of user accounts so service changes can only be performed by authorized administrators. Also monitor any service changes that may occur inadvertently.",
      "summary":"When an operating system starts, it also starts programs called services or daemons. Modifying existing services may break existing services or may enable services that are disabled/not commonly used."
    },
    {
      "id":"561",
      "name":"Windows Admin Shares with Stolen Credentials",
      "prerequisites":"",
      "related_weakness":[
        "522"
      ],
      "solutions":"Do not reuse local administrator account passwords across systems. Ensure password complexity and uniqueness such that the passwords cannot be cracked or guessed. Deny remote use of local admin credentials to log into systems. Do not allow accounts to be a local administrator on more than one system.",
      "summary":"Windows systems have hidden network shares that are only accessible to administrators and allow files to be written to the local computer. Example network shares include: C$, ADMIN$ and IPC$. Adversaries may use valid administrator credentials to remotely access a network share to transfer files and execute code. It is possible for adversaries to use NTLM hashes to access administrator shares on systems with certain configuration and patch levels."
    },
    {
      "id":"50",
      "name":"Password Recovery Exploitation",
      "prerequisites":"The system allows users to recover their passwords and gain access back into the system. Password recovery mechanism has been designed or implemented insecurely. Password recovery mechanism relies only on something the user knows and not something the user has. No third party intervention is required to use the password recovery mechanism.",
      "related_weakness":[
        "522",
        "640",
        "718"
      ],
      "solutions":"Use multiple security questions (e.g. have three and make the user answer two of them correctly). Let the user select their own security questions or provide them with choices of questions that are not generic. E-mail the temporary password to the registered e-mail address of the user rather than letting the user reset the password online. Ensure that your password recovery functionality is not vulnerable to an injection style attack.",
      "summary":"An attacker may take advantage of the application feature to help users recover their forgotten passwords in order to gain access into the system with the same privileges as the original user. Generally password recovery schemes tend to be weak and insecure. Most of them use only one security question . For instance, mother's maiden name tends to be a fairly popular one. Unfortunately in many cases this information is not very hard to find, especially if the attacker knows the legitimate user. These generic security questions are also re-used across many applications, thus making them even more insecure. An attacker could for instance overhear a coworker talking to a bank representative at the work place and supplying their mother's maiden name for verification purposes. An attacker can then try to log in into one of the victim's accounts, click on \"forgot password\" and there is a good chance that the security question there will be to provide mother's maiden name. A weak password recovery scheme totally undermines the effectiveness of a strong password scheme."
    },
    {
      "id":"560",
      "name":"Use of Known Domain Credentials",
      "prerequisites":"",
      "related_weakness":[
        "522"
      ],
      "solutions":"",
      "summary":"An adversary uses stolen credentials (e.g., userid and password) to access systems managed under the same credential framework on a local network. Often, users are allowed to login to connected machines using the same password. Discovery of the password on one machine allows for lateral movement to those machines."
    }
  ],
  "cvss":7.5,
  "cvss-time":"2022-01-07T20:40:00",
  "cvss-vector":"AV:N/AC:L/Au:N/C:P/I:P/A:P",
  "cwe":"CWE-522",
  "id":"CVE-2021-37400",
  "impact":{
    "availability":"PARTIAL",
    "confidentiality":"PARTIAL",
    "integrity":"PARTIAL"
  },
  "last-modified":"2022-01-07T20:40:00",
  "references":[
    "https://us.idec.com/idec-us/en/USD/Software-Downloads-Automation-Organizer",
    "https://www.idec.com/home/lp/pdf/2021-12-24-PLC.pdf",
    "https://us.idec.com/idec-us/en/USD/Programmable-Logic-Controller/Micro-PLC/FC6A-MicroSmart/c/MicroSmart_FC6A",
    "https://jvn.jp/en/vu/JVNVU92279973/"
  ],
  "summary":"An attacker may obtain the user credentials from the communication between the PLC and the software. As a result, the PLC user program may be uploaded, altered, and/or downloaded.",
  "vulnerable_configuration":[
    {
      "id":"cpe:2.3:a:idec:data_file_manager:*:*:*:*:*:*:*:*",
      "title":"cpe:2.3:a:idec:data_file_manager:*:*:*:*:*:*:*:*"
    },
    {
      "id":"cpe:2.3:a:idec:windedit:*:*:*:*:*:*:*:*",
      "title":"cpe:2.3:a:idec:windedit:*:*:*:*:*:*:*:*"
    },
    {
      "id":"cpe:2.3:a:idec:windldr:*:*:*:*:*:*:*:*",
      "title":"cpe:2.3:a:idec:windldr:*:*:*:*:*:*:*:*"
    },
    {
      "id":"cpe:2.3:o:idec:microsmart_plus_fc6b_firmware:*:*:*:*:*:*:*:*",
      "title":"cpe:2.3:o:idec:microsmart_plus_fc6b_firmware:*:*:*:*:*:*:*:*"
    },
    {
      "id":"cpe:2.3:h:idec:microsmart_plus_fc6b:-:*:*:*:*:*:*:*",
      "title":"cpe:2.3:h:idec:microsmart_plus_fc6b:-:*:*:*:*:*:*:*"
    },
    {
      "id":"cpe:2.3:o:idec:microsmart_plus_fc6a_firmware:*:*:*:*:*:*:*:*",
      "title":"cpe:2.3:o:idec:microsmart_plus_fc6a_firmware:*:*:*:*:*:*:*:*"
    },
    {
      "id":"cpe:2.3:h:idec:microsmart_plus_fc6a:-:*:*:*:*:*:*:*",
      "title":"cpe:2.3:h:idec:microsmart_plus_fc6a:-:*:*:*:*:*:*:*"
    },
    {
      "id":"cpe:2.3:o:idec:microsmart_fc6b_firmware:*:*:*:*:*:*:*:*",
      "title":"cpe:2.3:o:idec:microsmart_fc6b_firmware:*:*:*:*:*:*:*:*"
    },
    {
      "id":"cpe:2.3:h:idec:microsmart_fc6b:-:*:*:*:*:*:*:*",
      "title":"cpe:2.3:h:idec:microsmart_fc6b:-:*:*:*:*:*:*:*"
    },
    {
      "id":"cpe:2.3:o:idec:microsmart_fc6a_firmware:*:*:*:*:*:*:*:*",
      "title":"cpe:2.3:o:idec:microsmart_fc6a_firmware:*:*:*:*:*:*:*:*"
    },
    {
      "id":"cpe:2.3:h:idec:microsmart_fc6a:-:*:*:*:*:*:*:*",
      "title":"cpe:2.3:h:idec:microsmart_fc6a:-:*:*:*:*:*:*:*"
    },
    {
      "id":"cpe:2.3:o:idec:ft1a_smartaxix_pro_firmware:*:*:*:*:*:*:*:*",
      "title":"cpe:2.3:o:idec:ft1a_smartaxix_pro_firmware:*:*:*:*:*:*:*:*"
    },
    {
      "id":"cpe:2.3:h:idec:ft1a_smartaxix_pro:-:*:*:*:*:*:*:*",
      "title":"cpe:2.3:h:idec:ft1a_smartaxix_pro:-:*:*:*:*:*:*:*"
    },
    {
      "id":"cpe:2.3:o:idec:ft1a_smartaxix_lite_firmware:*:*:*:*:*:*:*:*",
      "title":"cpe:2.3:o:idec:ft1a_smartaxix_lite_firmware:*:*:*:*:*:*:*:*"
    },
    {
      "id":"cpe:2.3:h:idec:ft1a_smartaxix_lite:-:*:*:*:*:*:*:*",
      "title":"cpe:2.3:h:idec:ft1a_smartaxix_lite:-:*:*:*:*:*:*:*"
    }
  ],
  "vulnerable_configuration_cpe_2_2":[],
  "vulnerable_product":[
    "cpe:2.3:a:idec:data_file_manager:*:*:*:*:*:*:*:*",
    "cpe:2.3:a:idec:windedit:*:*:*:*:*:*:*:*",
    "cpe:2.3:a:idec:windldr:*:*:*:*:*:*:*:*",
    "cpe:2.3:o:idec:microsmart_plus_fc6b_firmware:*:*:*:*:*:*:*:*",
    "cpe:2.3:o:idec:microsmart_plus_fc6a_firmware:*:*:*:*:*:*:*:*",
    "cpe:2.3:o:idec:microsmart_fc6b_firmware:*:*:*:*:*:*:*:*",
    "cpe:2.3:o:idec:microsmart_fc6a_firmware:*:*:*:*:*:*:*:*",
    "cpe:2.3:o:idec:ft1a_smartaxix_pro_firmware:*:*:*:*:*:*:*:*",
    "cpe:2.3:o:idec:ft1a_smartaxix_lite_firmware:*:*:*:*:*:*:*:*"
  ]
}
````
Note: If you use the '-l' with value 2, It will print the last two recently published CVE.

[3]. Use '-cp' or '--capec', Run the following command
````
python app.py -cp 12
````
Then output wil be
````
The requested CAPEC id is 12 
 {
  "id":"12",
  "name":"Choosing Message Identifier",
  "prerequisites":"Information and client-sensitive (and client-specific) data must be present through a distribution channel available to all users. Distribution means must code (through channel, message identifiers, or convention) message destination in a manner visible within the distribution means itself (such as a control channel) or in the messages themselves.",
  "related_weakness":[
    "201",
    "306"
  ],
  "solutions":"The purpose is to architect the system in a way that associates proper authentication/authorization with each channel/message. Re-architect system input/output channels as appropriate to distribute self-protecting data. That is, encrypt (or otherwise protect) channels/messages so that only authorized readers can see them.",
  "summary":"This pattern of attack is defined by the selection of messages distributed over via multicast or public information channels that are intended for another client by determining the parameter value assigned to that client. This attack allows the adversary to gain access to potentially privileged information, and to possibly perpetrate other attacks through the distribution means by impersonation. If the channel/message being manipulated is an input rather than output mechanism for the system, (such as a command bus), this style of attack could be used to change the adversary's identifier to more a privileged one."
}

````
[4]. Use '-v' or '--vendor', Run the following command

````
python app.py -v apple
````
Then output wil be
````
The reuqested vendor search is apple 
 {
  "product":[
    "802.11n",
    "a_ux",
    "afp_server",
    "airport_base_station",
    "airport_base_station_firmware",
    "airport_card",
    "airport_express",
    "airport_express_base_station_firmware",
    "airport_extreme",
    "airport_extreme_base_station_firmware",
    "airport_utility",
    "apache_mod_digest_apple",
    "aperture",
    "apple_airport_extreme_base_station",
    "apple_laserwriter",
    "apple_music",
    "apple_remote_desktop",
    "apple_support",
    "apple_tv",
    "apple_type_services",
    "applescript",
    "appleshare",
    "appleshare_mail_server",
    "bomarchivehelper",
    "bonjour",
    "boot_camp",
    "carboncore",
    "cfnetwork",
    "chrome_os",
    "claris_emailer",
    "core_audio_technologies",
    "core_image_fun_house",
    "coregraphics",
    "cups",
    "darwin_streaming_server",
    "data_detectors_engine",
    "exposure_notification",
    "exposure_notifications",
    "files",
    "garageband",
    "ibooks_author",
    "ical",
    "ichat",
    "ichat_av",
    "ichat_server",
    "icloud",
    "icloud_for_windows",
    "imageio",
    "imovie",
    "installer",
    "instant_message_framework",
    "ios",
    "ipad",
    "ipad2",
    "ipad_mini",
    "ipad_os",
    "ipados",
    "iphone",
    "iphone_3gs",
    "iphone_configuration_web_utility",
    "iphone_os",
    "iphoto",
    "ipod_touch",
    "itunes",
    "itunes_u",
    "iwork",
    "java",
    "java_1.4",
    "java_1.5",
    "java_1.6",
    "keynote",
    "libsecurity",
    "logic_pro_x",
    "mac_os",
    "mac_os_runtime_for_java",
    "mac_os_server",
    "mac_os_x",
    "mac_os_x_preview.app",
    "mac_os_x_server",
    "macbook_air",
    "macos",
    "macos_server",
    "mail",
    "maos",
    "mdnsresponder",
    "minimal_slp_service_agent",
    "mobile_safari",
    "motion",
    "music",
    "nioextras",
    "numbers",
    "os_x_server",
    "pages",
    "pdfkit",
    "personal_web_sharing",
    "podcast_producer",
    "powerpc",
    "preview",
    "pykerberos",
    "quartz_composer",
    "quicklook",
    "quicktime",
    "quicktime_broadcaster",
    "quicktime_darwin_mp3_broadcaster",
    "quicktime_mpeg-2_playback_component",
    "quicktime_pictureviewer",
    "quicktime_streaming_server",
    "remote_desktop",
    "safari",
    "server_manager",
    "shazam",
    "shortcuts",
    "software_update",
    "swift",
    "swiftnio",
    "swiftnio_ssl",
    "tcp_ip_configuration_utility",
    "terminal",
    "textedit",
    "texture",
    "time_capsule",
    "tokend",
    "transporter",
    "tv_os",
    "tvos",
    "watch_os",
    "watchos",
    "webcore",
    "webkit",
    "weblog_server",
    "webobjects",
    "windows_migration_assistant",
    "xcode",
    "xcode_tools",
    "xsan",
    "xserve_lights-out_management"
  ],
  "vendor":"apple"
}

````

[5]. Use '-db' or '--dbinfo', Run the following command

````
python app.py -db
````
Then output wil be
````
The updated database record information is 
 {
  "capec":{
    "last_update":"2019-09-30T18:53:48",
    "size":570
  },
  "cpe":{
    "last_update":"2022-01-08T05:30:09",
    "size":689360
  },
  "cpeOther":{
    "last_update":"2020-10-02T05:15:22",
    "size":0
  },
  "cves":{
    "last_update":"2022-01-08T19:00:07",
    "size":179661
  },
  "cwe":{
    "last_update":"2020-06-25T22:10:26",
    "size":1245
  },
  "via4":{
    "last_update":"2021-01-23T15:47:42",
    "size":148446
  }
}
````
## Disabled in REST API
The following features are disabled in the REST API 
* Product & Vendor based search -  When vendor and product are specified, this API call returns a list of CVEs related to the product. 
* Return the CVE based key and value parameters.
